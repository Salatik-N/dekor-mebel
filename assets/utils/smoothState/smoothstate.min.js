/*!
 * smoothState.js is jQuery plugin that progressively enhances
 * page loads to behave more like a single-page application.
 *
 * @author  Miguel Ángel Pérez   reachme@miguel-perez.com
 * @see     http://smoothstate.com
 *
 */
!function(t){"use strict";"object"==typeof module&&"object"==typeof module.exports?t(require("jquery"),window,document):t(jQuery,window,document)}((function(t,e,n,o){"use strict";if(!e.history.pushState)return t.fn.smoothState=function(){return this},void(t.fn.smoothState.options={});if(!t.fn.smoothState){var a=t("html, body"),r=e.console,i={isExternal:function(t){var n=t.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof n[1]&&n[1].length>0&&n[1].toLowerCase()!==e.location.protocol||"string"==typeof n[2]&&n[2].length>0&&n[2].replace(new RegExp(":("+{"http:":80,"https:":443}[e.location.protocol]+")?$"),"")!==e.location.host},stripHash:function(t){return t.replace(/#.*/,"")},isHash:function(t,n){n=n||e.location.href;var o=t.indexOf("#")>-1,a=i.stripHash(t)===i.stripHash(n);return o&&a},translate:function(e){var n={dataType:"html",type:"GET"};return e="string"==typeof e?t.extend({},n,{url:e}):t.extend({},n,e)},shouldLoadAnchor:function(t,e,n){var a=t.prop("href");return!(i.isExternal(a)||i.isHash(a)||t.is(e)||t.prop("target")||typeof n!==o&&""!==n&&-1===t.prop("href").search(n))},clearIfOverCapacity:function(t,e){return Object.keys||(Object.keys=function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}),Object.keys(t).length>e&&(t={}),t},storePageIn:function(e,n,o,a,r,i){var s=t("<html></html>").append(t(o));return void 0===r&&(r={}),void 0===i&&(i=n),e[n]={status:"loaded",title:s.find("title").first().text(),html:s.find("#"+a),doc:o,state:r,destUrl:i},e},triggerAllAnimationEndEvent:function(e,n){n=" "+n||"";var o=0;e.on("animationstart webkitAnimationStart oanimationstart MSAnimationStart",(function(n){t(n.delegateTarget).is(e)&&(n.stopPropagation(),o++)})),e.on("animationend webkitAnimationEnd oanimationend MSAnimationEnd",(function(n){t(n.delegateTarget).is(e)&&(n.stopPropagation(),0===--o&&e.trigger("allanimationend"))})),e.on("allanimationend"+n,(function(){o=0,i.redraw(e)}))},redraw:function(t){t.height()}},s=function(s,l){var c,u=t(s),d=u.prop("id"),h=null,f=!1,p={},g={},m=e.location.href,v=function(t){(t=t||!1)&&p.hasOwnProperty(t)?delete p[t]:p={},u.data("smoothState").cache=p},y=function(e,n){n=n||t.noop;var o=i.translate(e);if(!(p=i.clearIfOverCapacity(p,l.cacheLength)).hasOwnProperty(o.url)||void 0!==o.data){p[o.url]={status:"fetching"};var a=t.ajax(o);a.done((function(t){i.storePageIn(p,o.url,t,d),u.data("smoothState").cache=p})),a.fail((function(){p[o.url].status="error"})),l.locationHeader&&a.always((function(t,e,n){var a=(t.statusCode?t:n).getResponseHeader(l.locationHeader);a&&(p[o.url].destUrl=a)})),n&&a.always(n)}},w=function(o){var i="#"+d,s=p[o]?t(p[o].html.html()):null;s.length?(n.title=p[o].title,u.data("smoothState").href=o,l.loadingClass&&a.removeClass(l.loadingClass),l.onReady.render(u,s),u.one("ss.onReadyEnd",(function(){f=!1,l.onAfter(u,s),l.scroll&&function(){if(h){var e=t(h,u);if(e.length){var n=e.offset().top;a.scrollTop(n)}h=null}}(),k(u)})),e.setTimeout((function(){u.trigger("ss.onReadyEnd")}),l.onReady.duration)):!s&&l.debug&&r?r.warn("No element with an id of "+i+" in response from "+o+" in "+p):e.location=o},S=function(t,n,o){var s=i.translate(t);void 0===n&&(n=!0),void 0===o&&(o=!0);var c=!1,h=!1,f={loaded:function(){var t=c?"ss.onProgressEnd":"ss.onStartEnd";if(h&&c?h&&w(s.url):u.one(t,(function(){w(s.url),o||v(s.url)})),n){var a=p[s.url].destUrl;g=l.alterChangeState({id:d},p[s.url].title,a),p[s.url].state=g,e.history.pushState(g,p[s.url].title,a)}h&&!o&&v(s.url)},fetching:function(){c||(c=!0,u.one("ss.onStartEnd",(function(){l.loadingClass&&a.addClass(l.loadingClass),l.onProgress.render(u),e.setTimeout((function(){u.trigger("ss.onProgressEnd"),h=!0}),l.onProgress.duration)}))),e.setTimeout((function(){p.hasOwnProperty(s.url)&&f[p[s.url].status]()}),10)},error:function(){l.debug&&r?r.log("There was an error loading: "+s.url):e.location=s.url}};p.hasOwnProperty(s.url)||y(s),l.onStart.render(u),e.setTimeout((function(){l.scroll&&a.scrollTop(0),u.trigger("ss.onStartEnd")}),l.onStart.duration),f[p[s.url].status]()},C=function(e){var n,o=t(e.currentTarget);i.shouldLoadAnchor(o,l.blacklist,l.hrefRegex)&&!f&&(e.stopPropagation(),n=i.translate(o.prop("href")),n=l.alterRequest(n),y(n))},b=function(e){var n=t(e.currentTarget);if(!e.metaKey&&!e.ctrlKey&&i.shouldLoadAnchor(n,l.blacklist,l.hrefRegex)&&(e.stopPropagation(),e.preventDefault(),!T())){O();var o=i.translate(n.prop("href"));f=!0,h=n.prop("hash"),o=l.alterRequest(o),l.onBefore(n,u),S(o)}},E=function(e){var n=t(e.currentTarget);if(!n.is(l.blacklist)&&(e.preventDefault(),e.stopPropagation(),!T())){O();var a={url:n.prop("action"),data:n.serialize(),type:n.prop("method")};f=!0,"get"===(a=l.alterRequest(a)).type.toLowerCase()&&(a.url=a.url+"?"+a.data),l.onBefore(n,u),S(a,o,l.allowFormCaching)}},P=0,T=function(){var t=null===l.repeatDelay,e=parseInt(Date.now())>P;return!(t||e)},O=function(){P=parseInt(Date.now())+parseInt(l.repeatDelay)},k=function(t){l.anchors&&l.prefetch&&t.find(l.anchors).not(l.prefetchBlacklist).on(l.prefetchOn,null,C)};return l=t.extend({},t.fn.smoothState.options,l),null===e.history.state?(g=l.alterChangeState({id:d},n.title,m),e.history.replaceState(g,n.title,m)):g={},i.storePageIn(p,m,n.documentElement.outerHTML,d,g),i.triggerAllAnimationEndEvent(u,"ss.onStartEnd ss.onProgressEnd ss.onEndEnd"),c=u,l.anchors&&(c.on("click",l.anchors,b),k(c)),l.forms&&c.on("submit",l.forms,E),{href:m,cache:p,clear:v,load:S,fetch:y,restartCSSAnimations:function(){var t=u.prop("class");u.removeClass(t),i.redraw(u),u.addClass(t)}}};e.onpopstate=function(n){if(null!==n.state){var o=e.location.href,a=t("#"+n.state.id).data("smoothState"),r=a.href!==o&&!i.isHash(o,a.href),s=n.state!==a.cache[a.href].state;(r||s)&&(s&&a.clear(a.href),a.load(o,!1))}},t.smoothStateUtility=i,t.fn.smoothState=function(e){return this.each((function(){var n=this.tagName.toLowerCase();this.id&&"body"!==n&&"html"!==n&&!t.data(this,"smoothState")?t.data(this,"smoothState",new s(this,e)):!this.id&&r?r.warn("Every smoothState container needs an id but the following one does not have one:",this):"body"!==n&&"html"!==n||!r||r.warn("The smoothstate container cannot be the "+this.tagName+" tag")}))},t.fn.smoothState.options={debug:!1,anchors:"a",hrefRegex:"",forms:"form",allowFormCaching:!1,repeatDelay:500,blacklist:".no-smoothState",prefetch:!1,prefetchOn:"mouseover touchstart",prefetchBlacklist:".no-prefetch",locationHeader:"X-SmoothState-Location",cacheLength:0,loadingClass:"is-loading",scroll:!0,alterRequest:function(t){return t},alterChangeState:function(t,e,n){return t},onBefore:function(t,e){},onStart:{duration:0,render:function(t){}},onProgress:{duration:0,render:function(t){}},onReady:{duration:0,render:function(t,e){t.html(e)}},onAfter:function(t,e){}}}})),function(t){function e(){t("a").each((function(){-1===this.href.indexOf("/wp-admin/")&&-1===this.href.indexOf("/wp-login.php")||t(this).addClass("wp-link")}))}t((function(){e();var n={anchors:"a",blacklist:".wp-link",onStart:{duration:280,render:function(e){t("#page-content").addClass("slide-out"),t("#page-content").addClass("wow"),t("#page-content").addClass("slideInRight")}},onAfter:function(n){e();var o=t(window.location.hash);if(0!==o.length){var a=o.offset().top;t("body, html").animate({scrollTop:a-60},{duration:280})}t("#page-content").removeClass("slide-out"),t("#page-content").addClass("wow"),t("#page-content").addClass("slideInLeft")}};t("#page-content").smoothState(n)}))}(jQuery);